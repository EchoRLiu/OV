DESCRIPTION:

[LONGITUDINAL]
input = {rho, kappa, psi, phi, beta, alpha, delta, theta, scaling}

PK:
depot(target = V)

EQUATION:
  ; State variables and their derivatives
  ddt_Cu = exp(rho) * Cu * (1 - (Cu + Ci) / exp(kappa)) - exp(psi) * V * Cu
  ddt_Ci = exp(rho) * Ci * (1 - (Cu + Ci) / exp(kappa)) + exp(psi) * V * Cu - exp(alpha) * Lp * Ci
  ddt_Lp = exp(phi) * Ci - exp(alpha) * Lp^2
  ddt_V  = exp(beta) * exp(alpha) * Lp * Ci - exp(psi) * V * Cu - exp(delta) * V

  ; Initial conditions
  ; t=0 is when the virus is injected
  t_0 = 0
  ; Assuming the tumor was injected at t = -1
  Cu_0 = 1 / (1 / exp(kappa) + exp(-exp(rho) * 1) * (1 / (400 * exp(theta)) - 1 / exp(kappa)))  ; Initial uninfected tumor cells
  Ci_0 = 0  ; Initial infected tumor cells
  Lp_0 = 0  ; Initial lysis-inducing protein
  V_0  = 0; Virus injection at t=0 for vvDD condition
  
  ; output
  tumor_vol = scaling * (Cu + Ci)

OUTPUT:
  output = {tumor_vol}
